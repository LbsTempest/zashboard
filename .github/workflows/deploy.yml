# å·¥ä½œæµåç§°
name: Build and Deploy to GitHub Pages

# è§¦å‘å™¨
on:
  # è§¦å‘æ–¹å¼ä¸€ï¼šåœ¨æ¨é€åˆ° main åˆ†æ”¯æ—¶è‡ªåŠ¨è¿è¡Œ
  push:
    branches:
      - main
      
  # è§¦å‘æ–¹å¼äºŒï¼šå…è®¸åœ¨ Actions é¡µé¢æ‰‹åŠ¨è§¦å‘æ­¤å·¥ä½œæµ
  workflow_dispatch:

# æƒé™è®¾ç½®ï¼šå…è®¸å·¥ä½œæµå‘ä½ çš„ä»“åº“å†™å…¥å†…å®¹ï¼ˆç”¨äºæ¨é€ gh-pages åˆ†æ”¯ï¼‰
permissions:
  contents: write

# ä»»åŠ¡å®šä¹‰
jobs:
  # å•ä¸ªä»»åŠ¡ï¼Œè´Ÿè´£æ„å»ºå’Œéƒ¨ç½²
  build-and-deploy:
    # è¿è¡Œç¯å¢ƒ
    runs-on: ubuntu-latest
    
    # ä»»åŠ¡æ­¥éª¤
    steps:
      # æ­¥éª¤1: æ£€å‡ºï¼ˆä¸‹è½½ï¼‰ä½ çš„ä»“åº“ä»£ç 
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      # æ­¥éª¤2: è®¾ç½® Node.js å’Œ pnpm ç¯å¢ƒ
      - name: Set up Node.js and pnpm ğŸ”§
        uses: actions/setup-node@v4
        with:
          node-version: '20' # æŒ‡å®šä¸€ä¸ªæ˜ç¡®çš„ Node.js ç‰ˆæœ¬
      - uses: pnpm/action-setup@v4

      # æ­¥éª¤3: å®‰è£…ä¾èµ–å¹¶æ„å»ºé¡¹ç›®
      - name: Install and Build ğŸ—ï¸
        run: |
          pnpm i
          pnpm run build
      
      # æ­¥éª¤4: éƒ¨ç½²åˆ° GitHub Pages
      - name: Deploy ğŸš€
        uses: peaceiris/actions-gh-pages@v4
        with:
          # ä½¿ç”¨ GitHub è‡ªåŠ¨æä¾›çš„ä»¤ç‰Œï¼Œæ— éœ€åˆ›å»ºä¸ªäººè®¿é—®ä»¤ç‰Œï¼ˆPATï¼‰
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # è¦éƒ¨ç½²çš„æ–‡ä»¶å¤¹
          publish_dir: ./dist
